@echo off

REM -------------------------------------------------------------
REM SET THE C SHARP COMPILER LOCATION USING BACKSLASHES AND QUOTES
SET CSC=C:\WINDOWS\Microsoft.NET\Framework\v3.5\csc.exe

REM -----------------------------------------------------------------------------------
REM DO NOT EDIT BELOW HERE
SET SRC_FOLDER=SRC
SET BIN_FOLDER=BIN

REM SET UP A DESTINATION FOLDER FOR BINARIES
ECHO.
ECHO CLEAR BIN FOLDER
DEL /S /Q .\%BIN_FOLDER%
MKDIR %BIN_FOLDER%

ECHO.
echo CREATE THE HEXIFY APPLICATION
%CSC% /out:%BIN_FOLDER%\ashex.exe %SRC_FOLDER%\030_BUILD_SIMILARITY\010_HEXIFY\ashex.cs 

ECHO.
ECHO CONVERT THE SIMMETRICS DLL TO HEX
ECHO.
ECHO CONVERT SIMMETRICS DLL TO HEX FILE FOR LOADING INTO SQLSERVER
%BIN_FOLDER%\ashex.exe < %SRC_FOLDER%\020_BUILD_SIMMETRICS\SimMetrics.dll  > %BIN_FOLDER%\SimMetrics_1.5.dll.HEX

ECHO.
ECHO COMPILE THE SQL SERVER WRAPPER FUNCTIONS INTO A DLL
ECHO This is the SQL Server Assembly DLL that wrap around the Simmetrics DLL
REM %CSC% /r:%SRC_FOLDER%\020_BUILD_SIMMETRICS\SimMetrics.dll /target:library /out:%SRC_FOLDER%\030_BUILD_SIMILARITY\030_DLL\SIMILARITY_001.dll %SRC_FOLDER%\030_BUILD_SIMILARITY\030_DLL\SIMILARITY\Similarity.cs
%CSC% /r:%SRC_FOLDER%\020_BUILD_SIMMETRICS\SimMetrics.dll /target:library /out:%BIN_FOLDER%\SIMILARITY_001.dll %SRC_FOLDER%\030_BUILD_SIMILARITY\030_DLL\SIMILARITY\Similarity.cs

ECHO.
ECHO CONVERT THE SQL SERVER WRAPPER FUNCTIONS DLL TO HEX
ECHO This is a hack to allow easy loading of the DLL when
ECHO you don't have access to the SQL Server server
%BIN_FOLDER%\ashex.exe < %BIN_FOLDER%\SIMILARITY_001.dll  > %BIN_FOLDER%\SIMILARITY_001.dll.HEX

ECHO.
ECHO OUTPUT DLL FILE AS HEX 

ECHO.
ECHO Now edit your SQL Server load scripts

pause
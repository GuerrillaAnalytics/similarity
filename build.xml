<project name="Similarity" default="projecthelp" > 
<!-- 
	Project build file
-->	

<!-- **********************************************************************-->
<!-- Project directories -->
<!-- **********************************************************************-->
<property name="dir.src" location="src"/>
<property name="dir.build" location="build"/>
<property name="dir.dist"  location="dist"/>

<!-- *****************************************************************
Semantic versioning properties
-->
<property name="major.version" value="1"/>
<property name="minor.version" value="0"/>
<property name="patch.version" value="0"/>


<property name="semantic.version" value="${major.version}.${minor.version}.${patch.version}"/>



<target name="init" 
	description="Create the project folder structure for executing project build">
	<!-- Create the time stamp -->
	<tstamp/>
	<!-- Create the build directory structure used by compile -->
	<mkdir dir="${dir.build}"/>
	<mkdir dir="${dir.dist}"/>
</target>

<target name="clean" depends="init"
	description="Clean up temp folders and files" >
	
	
	<!-- Delete the ${build} and ${dist} directory trees -->
<!--
	<if>
	  <available file="${dir.build}" type="dir" />
	  <then>
		<delete dir="${dir.build}"/>
	  </then>
	</if>

	<if>
	  <available file="${dir.dist}" type="dir" />
	  <then>
		<delete dir="${dir.dist}"/>
	  </then>
	</if>	
-->	
	
	
	<delete includeEmptyDirs="true">
		<fileset dir="${dir.build}">
			<include name="*/**" />
		</fileset>
		<fileset dir="${dir.dist}">
			<include name="*/**" />
		</fileset>
	</delete>
	
</target>


<target name="dist" depends="clean,init"
	description="Generate the distribution zip file" >

	<!--	Create version info file that application may use -->
    <tstamp>
        <format property="built_at" pattern="yyyy-MM-dd hh:mm"/>
    </tstamp>        

    <propertyfile file="${dir.src}/bobcat/versionInfo.properties"
        comment="This file is automatically generated - DO NOT EDIT">        
        <entry key="buildtime" value="${built_at}"/>
        <entry key="major.version" value="${major.version}"/>
        <entry key="minor.version" value="${minor.version}"/>
		<entry key="patch.version" value="${patch.version}"/>
    </propertyfile>

	<!--	Copy the licence file into subfolder -->
	<copy file="licence.txt" todir="${dir.build}/bobcat/"/>
	
	<!-- Copy all files to build folder -->
	<copy todir="${dir.build}">
		<fileset dir="${dir.src}" includes="**/*.*"/>
	</copy>
	


	
	<!--	rename all .bat files as they cause security problems -->
	<!--
	<move todir="${dir.build}" includeemptydirs="true">
		<fileset dir="${dir.build}">
		  <include name="**/*.bat"/>
		</fileset>
		<mapper type="glob" from="*" to="*.bak"/>
	</move>	
	-->
	
	<!-- zip up files into a distribution archive -->
	<zip destfile="${dir.dist}/${ant.project.name}-${semantic.version}.zip"
	   basedir="${dir.build}"
	   update="false"
	/>
  
</target>

  
<!-- Default into help info-->	
<target name="projecthelp" >
	<java classname="org.apache.tools.ant.Main">
	  <arg value="-projecthelp" />
	  <arg value="-buildfile" />
	 <arg value="${ant.file}" />
	</java>
</target>


<target name="about">
	<echo message=""/> 
	<echo message="----------------------------------------------------------------"/>
</target>
	
	
</project>